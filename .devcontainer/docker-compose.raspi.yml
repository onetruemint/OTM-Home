name: otm-home-raspi
env_file:
  - path: ./.env.raspi
    required: true
networks:
  otm-home-raspi:
    name: otm-home-raspi
    driver: bridge
services:
  otm-home-portal:
    build:
      context: ..
      dockerfile: apps/portal/Dockerfile.monorepo
      platforms:
        - ${DOCKER_PLATFORM}
    container_name: otm-home-portal
    ports:
      - "9000:9000"
    networks:
      - otm-home-raspi
    environment:
      # Backend server configuration - set these to your backend server's IP/hostname
      KAFKA_BROKERS: ${BACKEND_KAFKA_BROKERS:-BACKEND_SERVER_IP:9092}
      NODE_ENV: production
      PORT: 9000
    restart: unless-stopped

  otm-home-mongo-express:
    image: ${MONGO_EXPRESS_IMAGE:-mongo-express:latest}
    platform: ${DOCKER_PLATFORM:-linux/amd64}
    container_name: otm-home-mongo-express
    networks:
      - otm-home-raspi
    restart: unless-stopped
    ports:
      - "8082:8081"
    environment:
      # Backend server configuration - set this to your backend server's IP/hostname
      ME_CONFIG_MONGODB_URL: ${BACKEND_MONGO_URL:-mongodb://otm-home-user:otm-home-password@BACKEND_SERVER_IP:27017}
      ME_CONFIG_BASICAUTH_ENABLED: true
      ME_CONFIG_BASICAUTH_USERNAME: ${MONGO_EXPRESS_USER:-mint}
      ME_CONFIG_BASICAUTH_PASSWORD: ${MONGO_EXPRESS_PASSWORD:-pass}
